{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://ucp.dev/schemas/profile.json",
  "title": "UCP Discovery Profile",
  "description": "Full UCP discovery profile for /.well-known/ucp endpoint",
  "type": "object",
  "required": ["ucp"],
  "properties": {
    "ucp": {
      "type": "object",
      "required": ["version", "services", "capabilities"],
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
          "description": "UCP protocol version in YYYY-MM-DD format"
        },
        "merchant": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "description": { "type": "string" },
            "logo_url": { "type": "string", "format": "uri" },
            "website": { "type": "string", "format": "uri" },
            "primary_domain": { "type": "string" },
            "support_email": { "type": "string", "format": "email" }
          }
        },
        "services": {
          "type": "object",
          "description": "Service definitions keyed by reverse-domain name",
          "additionalProperties": {
            "type": "object",
            "required": ["version", "spec"],
            "properties": {
              "version": {
                "type": "string",
                "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
              },
              "spec": { "type": "string", "format": "uri" },
              "rest": {
                "type": "object",
                "required": ["endpoint", "schema"],
                "properties": {
                  "endpoint": { "type": "string", "format": "uri" },
                  "schema": { "type": "string", "format": "uri" }
                }
              },
              "mcp": {
                "type": "object",
                "required": ["endpoint", "schema"],
                "properties": {
                  "endpoint": { "type": "string", "format": "uri" },
                  "schema": { "type": "string", "format": "uri" }
                }
              }
            }
          }
        },
        "capabilities": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["name", "version", "spec", "schema"],
            "properties": {
              "name": {
                "type": "string",
                "pattern": "^[a-z][a-z0-9]*(?:\\.[a-z][a-z0-9_]*)+$"
              },
              "version": {
                "type": "string",
                "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
              },
              "spec": { "type": "string", "format": "uri" },
              "schema": { "type": "string", "format": "uri" },
              "extends": { "type": "string" },
              "config": { "type": "object" }
            }
          }
        }
      }
    },
    "signing_keys": {
      "type": "array",
      "description": "JWK public keys for signature verification",
      "items": {
        "type": "object",
        "required": ["kty", "kid"],
        "properties": {
          "kty": { "type": "string" },
          "kid": { "type": "string" },
          "use": { "type": "string" },
          "alg": { "type": "string" },
          "crv": { "type": "string" },
          "x": { "type": "string" },
          "y": { "type": "string" }
        }
      }
    },
    "payment": {
      "type": "object",
      "description": "Payment configuration",
      "properties": {
        "handlers": { "type": "array" }
      }
    }
  }
}
